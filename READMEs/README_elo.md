# 《图灵阿瓦隆》七人局天梯 ELO 机制说明

---

## **一、基础规则**

1. **游戏胜负**

  - 蓝方（4人）需要完成3次任务成功
  - 红方（3人）需要破坏3次任务或刺杀梅林
  - **最终胜负只有一方胜利**（无平局，除非游戏意外中止触发惩罚）

2. **ELO天梯**

  - 按照 ELO 机制，《图灵阿瓦隆》游戏平台中显示的 `分数` 即某位玩家的 **ELO 分数** 。
  - 当用户注册之后，其**自动被赋予 1200 分的初始 ELO 积分**，并开始参与 ELO 天梯排名。
  - 参与对战游戏，平台主要根据游戏胜负增加/减少您的 ELO 分数（详情见后文）。
  - 踊跃参与对战，积极优化代码，努力成为大师，努力成为金字塔的塔尖！

---

## **二、ELO分数计算机制**

### 1. **基础公式**

所有玩家根据**胜负结果**调整分数：

$$
\Delta ELO = K \times (结果 - 预期胜率)
$$

- **结果**：胜利为 `1` ，失败为 `0`
- **预期胜率**：根据双方队伍平均ELO计算（公式见下文）
- ***K* 值**：32（暂定）

### 2. **预期胜率计算**

根据队伍平均ELO预测胜负概率：

$$
预期胜率_{\text{蓝方}} = \frac{1}{1 + 10^{(E_{\text{红方}} - E_{\text{蓝方}})/400}}
$$

- $E_{\text{蓝方}}$：蓝方队伍平均ELO
- $E_{\text{红方}}$：红方队伍平均ELO

### 3. **犯规惩罚**

若一局中出现某位玩家代码报错或输出信息不合理等犯规行为，**游戏立即结束，进行犯规处理**：

**处理方式**：  

1. 扣除犯规玩家 $|E_{\text{蓝方}} - E_{\text{红方}}| \times 2$ 分数
2. 本局判定为**平局**，其他玩家ELO不变

---

## **四、计算示例**

### 场景描述

- **蓝方**平均ELO 1500，**红方**平均ELO 1550

### 计算步骤

1. **预期胜率**：

  $$
  预期胜率_{\text{蓝方}} = \frac{1}{1 + 10^{(1550-1500)/400}} \approx 0.45
  $$

2. **加/减分**：

  $$
  \Delta ELO = 20 \times (1 - 0.45) = 20 \times 0.55 = +11
  $$

  四舍五入后，该玩家最终ELO**增加**11分。

  \* 对于失败的玩家， $\Delta ELO < 0$ ，该玩家最终遭到减分。

---

> **📢欢迎就 ELO 机制的细节进行讨论（即使您不在技术组中）**！请把观点或问题加到 [Issue](https://github.com/pkulab409/pkudsa.avalon/issues/10) 中。